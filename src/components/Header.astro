<header
    id="main-header"
    class="fixed top-0 left-0 w-full z-50 py-6 px-6 transition-all duration-300 text-chocolate"
>
    <div class="container mx-auto flex justify-between items-center">
        <a href="/" class="relative z-50 group">
            <h1
                class="text-3xl md:text-4xl font-playfair font-bold tracking-tighter"
            >
                Deli<span
                    class="text-soft-pink group-hover:text-chocolate transition-colors duration-300"
                    >Bums</span
                >
            </h1>
        </a>

        <!-- Desktop Nav -->
        <nav
            class="hidden md:flex gap-12 font-sans text-sm tracking-widest uppercase items-center font-medium"
        >
            <a
                href="/"
                class="magnetic-link hover:text-soft-pink transition-colors"
                >Inicio</a
            >
            <a
                href="/catalog"
                class="magnetic-link hover:text-soft-pink transition-colors"
                >Cat치logo</a
            >
            <a
                href="/reviews"
                class="magnetic-link hover:text-soft-pink transition-colors"
                >Rese침as</a
            >
        </nav>

        <!-- Mobile Menu Button -->
        <button
            id="menu-toggle"
            class="md:hidden z-50 focus:outline-none relative w-10 h-10 flex flex-col justify-center items-end gap-1.5 group text-chocolate"
        >
            <span
                class="w-8 h-0.5 bg-current transition-all duration-300 group-hover:w-10"
            ></span>
            <span
                class="w-6 h-0.5 bg-current transition-all duration-300 group-hover:w-10"
            ></span>
            <span
                class="w-4 h-0.5 bg-current transition-all duration-300 group-hover:w-10"
            ></span>
        </button>
    </div>
</header>

<!-- Mobile Overlay Menu -->
<div
    id="mobile-menu"
    class="fixed inset-0 z-40 bg-chocolate text-cream flex flex-col justify-center items-center opacity-0 pointer-events-none"
>
    <nav class="flex flex-col gap-8 text-center">
        <a
            href="/"
            class="mobile-link text-5xl font-playfair hover:text-terracotta transition-colors overflow-hidden"
            ><span class="block translate-y-full">Inicio</span></a
        >
        <a
            href="/catalog"
            class="mobile-link text-5xl font-playfair hover:text-terracotta transition-colors overflow-hidden"
            ><span class="block translate-y-full">Cat치logo</span></a
        >
        <a
            href="/reviews"
            class="mobile-link text-5xl font-playfair hover:text-terracotta transition-colors overflow-hidden"
            ><span class="block translate-y-full">Rese침as</span></a
        >
    </nav>
</div>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    document.addEventListener("DOMContentLoaded", () => {
        const header = document.getElementById("main-header");
        const menuToggle = document.getElementById("menu-toggle");
        const mobileMenu = document.getElementById("mobile-menu");
        const mobileLinks = document.querySelectorAll(".mobile-link span");
        let isMenuOpen = false;

        // Scroll Effect (Solid background on scroll)
        window.addEventListener("scroll", () => {
            if (header) {
                if (window.scrollY > 50) {
                    header.classList.remove("py-6", "text-chocolate");
                    header.classList.add(
                        "py-3",
                        "bg-white/90",
                        "backdrop-blur-md",
                        "shadow-sm",
                        "text-chocolate",
                    );
                } else {
                    header.classList.add("py-6", "text-chocolate");
                    header.classList.remove(
                        "py-3",
                        "bg-white/90",
                        "backdrop-blur-md",
                        "shadow-sm",
                    );
                }
            }
        });

        // Mobile Menu Animation
        const menuTl = gsap.timeline({ paused: true });

        menuTl
            .to(mobileMenu, {
                opacity: 1,
                pointerEvents: "all",
                duration: 0.5,
                ease: "power2.inOut",
            })
            .to(
                mobileLinks,
                {
                    y: 0,
                    stagger: 0.1,
                    duration: 0.6,
                    ease: "power3.out",
                },
                "-=0.2",
            );

        if (menuToggle && header) {
            menuToggle.addEventListener("click", () => {
                isMenuOpen = !isMenuOpen;
                if (isMenuOpen) {
                    menuTl.play();
                    header.classList.remove("text-chocolate");
                    header.classList.add("text-cream");
                    menuToggle.classList.remove("text-chocolate");
                    menuToggle.classList.add("text-cream");
                } else {
                    menuTl.reverse();
                    setTimeout(() => {
                        header.classList.add("text-chocolate");
                        header.classList.remove("text-cream");
                        menuToggle.classList.add("text-chocolate");
                        menuToggle.classList.remove("text-cream");
                    }, 500);
                }
            });
        }

        // Magnetic Links (Desktop)
        document.querySelectorAll(".magnetic-link").forEach((link) => {
            link.addEventListener("mousemove", (e) => {
                const rect = (link as HTMLElement).getBoundingClientRect();
                const x =
                    (e as MouseEvent).clientX - rect.left - rect.width / 2;
                const y =
                    (e as MouseEvent).clientY - rect.top - rect.height / 2;

                gsap.to(link, {
                    x: x * 0.3,
                    y: y * 0.3,
                    duration: 0.3,
                    ease: "power2.out",
                });
            });

            link.addEventListener("mouseleave", () => {
                gsap.to(link, {
                    x: 0,
                    y: 0,
                    duration: 0.3,
                    ease: "elastic.out(1, 0.5)",
                });
            });
        });
    });
</script>
